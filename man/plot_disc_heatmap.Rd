% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PLOT-disc_heatmap.R
\name{plot_disc_heatmap}
\alias{plot_disc_heatmap}
\title{Plot discriminant features as Group Ã— Feature heatmap}
\usage{
plot_disc_heatmap(
  disc_obj,
  metadata,
  group_col,
  feature_col = "KO",
  top_n = 40
)
}
\arguments{
\item{disc_obj}{Object stored as attr(, "rbims_disc") from get_subset_discriminant().}

\item{metadata}{Metadata table with columns \code{Bin_name} and \code{group_col}.}

\item{group_col}{Grouping variable in metadata (e.g. "Depth").}

\item{feature_col}{...}

\item{top_n}{Number of top features to display (ranked by consensus score).}
}
\value{
A ggplot object.
}
\description{
This heatmap summarizes, for each group level (e.g., Depth),
the percentage of MAGs where each discriminant feature is present
(presence defined as Abundance > 0).
}
\details{
This function is robust to an empty \code{tibble_disc} because it uses
\code{disc_obj$mat_counts} (generated by the discriminant pipeline).
}
