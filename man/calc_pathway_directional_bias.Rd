% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CALC-pathway_directional_bias.R
\name{calc_pathway_directional_bias}
\alias{calc_pathway_directional_bias}
\title{Calculate pathway-level directional bias (binomial test)}
\usage{
calc_pathway_directional_bias(
  disc_obj,
  ko_dictionary,
  pathways = NULL,
  p_null = 0.5,
  p_alternative = c("greater", "less", "two.sided"),
  ci_two_sided = TRUE,
  conf_level = 0.95,
  drop_na_effect = TRUE
)
}
\arguments{
\item{disc_obj}{The discriminant object (attr(, "rbims_disc")) containing
at least \code{consensus} with columns \code{feature} and \code{effect}.}

\item{ko_dictionary}{A KO dictionary as produced by \code{make_ko_dictionary()},
with columns \code{KO} and \code{rbims_pathway}.}

\item{pathways}{Character vector of pathways to test (values from \code{rbims_pathway}).}

\item{p_null}{Null proportion for directionality. Default 0.5.}

\item{p_alternative}{Alternative hypothesis for directionality p-value.
Default "greater" tests whether prop(effect>0) > 0.5.}

\item{ci_two_sided}{Logical. If TRUE, compute a two-sided 95\% exact CI
for the proportion (Clopperâ€“Pearson), while keeping a directional p-value
defined by \code{p_alternative}. This is often preferable for figures.}

\item{conf_level}{Confidence level for CI. Default 0.95.}

\item{drop_na_effect}{If TRUE, drop rows with NA effect before calculations.}
}
\value{
A tibble with \code{rbims_pathway}, \code{x_pos}, \code{n}, \code{prop_pos},
\code{ci_low}, \code{ci_high}, \code{p_value}, \code{p_adj_fdr}.
}
\description{
Aggregates KO-level effects into pathway-level directionality statistics.
This is useful when many genes in a pathway consistently shift in the same
direction even if individual KO tests are not significant.
}
\details{
Effect direction convention:
\itemize{
\item \code{effect > 0} means enrichment toward the "positive" group in your contrast
(depends on how the contrast is built in the discriminant pipeline).
}
}
