<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create KEGG profile • rbims</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Create KEGG profile">
<meta property="og:description" content="rbims">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@MirnaVRL">
<meta name="twitter:site" content="@MirnaVRL">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-000000-01"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-000000-01');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rbims</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Create_Interpro_profile.html">Create Interpro profile</a>
    </li>
    <li>
      <a href="../articles/Create_KEGG_profile.html">Create KEGG profile</a>
    </li>
    <li>
      <a href="../articles/Explore_InterProScan_profile.html">Explore InterProScan profile</a>
    </li>
    <li>
      <a href="../articles/Explore_KEGG_profile.html">Explore KEGG profile</a>
    </li>
    <li>
      <a href="../articles/Installation.html">Installation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mirnavazquez/RbiMs/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Create_KEGG_profile_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Create KEGG profile</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mirnavazquez/RbiMs/blob/master/vignettes/Create_KEGG_profile.Rmd"><code>vignettes/Create_KEGG_profile.Rmd</code></a></small>
      <div class="hidden name"><code>Create_KEGG_profile.Rmd</code></div>

    </div>

    
    
<p>First, load the rbims package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mirnavazquez/RbiMs">rbims</a></span><span class="op">)</span></code></pre></div>
<p>The second thing to do would be to read the <a href="https://github.com/mirnavazquez/RbiMs/blob/main/inst/extdata/KEGG_bins.txt">KofamKOALA/KofamScan</a> output.</p>
<div id="read-the-kegg-results" class="section level2">
<h2 class="hasAnchor">
<a href="#read-the-kegg-results" class="anchor"></a>Read the KEGG results</h2>
<p>The function that rbims uses to read the raw output from the KofamKOALA/KofamScan data and make a table is <a href="https://mirnavazquez.github.io/RbiMs/reference/read_ko.html">read_ko</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">read_ko</span></code></pre></div>
<p><code>rbims</code> contains a test dataset that allow us to test this function. This dataset is saved in objects: <code>ko_bin_table</code>, <code>ko_bin_mapp</code>, and <code>metadata</code>. First download the <a href="https://github.com/mirnavazquez/RbiMs/blob/main/inst/extdata/KEGG_bins.txt">KofamKOALA/KofamScan</a> example file. It is recommended that you save this file in its own folder since this function will read all the text files in your path and concatenate them. An example of a path input is shown below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ko_bin_table</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/read_ko.html">read_ko</a></span><span class="op">(</span>data_kofam <span class="op">=</span><span class="st">"C:/Users/Bins"</span><span class="op">)</span></code></pre></div>
<p>The read_ko function will create a table that contains the abundance of each KO within each bin.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ko_bin_table</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 4</span>
<span class="co">#&gt;   Bin_name Scaffold_name      KO     Abundance</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;              &lt;chr&gt;      &lt;int&gt;</span>
<span class="co">#&gt; 1 Bin_10   scaffold_10_c1_10  K09800         1</span>
<span class="co">#&gt; 2 Bin_10   scaffold_10_c1_100 K01126         2</span>
<span class="co">#&gt; 3 Bin_10   scaffold_10_c1_103 K00616         1</span>
<span class="co">#&gt; 4 Bin_10   scaffold_10_c1_104 K05539         1</span>
<span class="co">#&gt; 5 Bin_10   scaffold_10_c1_107 K13936         1</span>
<span class="co">#&gt; 6 Bin_10   scaffold_10_c1_109 K01885         1</span></code></pre></div>
</div>
<div id="map-to-the-kegg-database" class="section level2">
<h2 class="hasAnchor">
<a href="#map-to-the-kegg-database" class="anchor"></a>Map to the KEGG database</h2>
<p>The function <a href="https://mirnavazquez.github.io/RbiMs/reference/mapping_ko.html">mapping_ko</a> can now be used to map the KO and their abundance to the rest of the features of KEGG and rbims database.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ko_bin_mapp</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/mapping_ko.html">mapping_ko</a></span><span class="op">(</span><span class="va">ko_bin_table</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ko_bin_mapp</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 19</span>
<span class="co">#&gt;   Module Module_description       Pathway  Pathway_descript~ Cycle Pathway_cycle</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                    &lt;chr&gt;    &lt;chr&gt;             &lt;chr&gt; &lt;chr&gt;        </span>
<span class="co">#&gt; 1 &lt;NA&gt;   &lt;NA&gt;                     &lt;NA&gt;     &lt;NA&gt;              &lt;NA&gt;  &lt;NA&gt;         </span>
<span class="co">#&gt; 2 &lt;NA&gt;   &lt;NA&gt;                     map00564 Glycerophospholi~ &lt;NA&gt;  &lt;NA&gt;         </span>
<span class="co">#&gt; 3 M00004 Pentose phosphate pathw~ map00030 Pentose phosphat~ &lt;NA&gt;  &lt;NA&gt;         </span>
<span class="co">#&gt; 4 M00007 Pentose phosphate pathw~ map00030 Pentose phosphat~ &lt;NA&gt;  &lt;NA&gt;         </span>
<span class="co">#&gt; 5 M00004 Pentose phosphate pathw~ map01100 Metabolic pathwa~ &lt;NA&gt;  &lt;NA&gt;         </span>
<span class="co">#&gt; 6 M00007 Pentose phosphate pathw~ map01100 Metabolic pathwa~ &lt;NA&gt;  &lt;NA&gt;         </span>
<span class="co">#&gt; # ... with 13 more variables: Detail_cycle &lt;chr&gt;, Genes &lt;chr&gt;,</span>
<span class="co">#&gt; #   Gene_description &lt;chr&gt;, Enzyme &lt;chr&gt;, KO &lt;chr&gt;, rbims_pathway &lt;chr&gt;,</span>
<span class="co">#&gt; #   rbims_sub_pathway &lt;chr&gt;, Bin_10 &lt;int&gt;, Bin_12 &lt;int&gt;, Bin_56 &lt;int&gt;,</span>
<span class="co">#&gt; #   Bin_113 &lt;int&gt;, Bin_1 &lt;int&gt;, Bin_2 &lt;int&gt;</span></code></pre></div>
<p>You can export this to a table like this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">ko_bin_mapp</span>, <span class="st">"KEGG_mapped.tsv"</span>, quote <span class="op">=</span> <span class="cn">F</span>, sep <span class="op">=</span> <span class="st">"\t"</span>, row.names <span class="op">=</span> <span class="cn">F</span>, col.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mirna Vázquez-Rosas-Landa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
